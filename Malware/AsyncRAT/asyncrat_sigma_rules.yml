# Sigma Rules for AsyncRAT Detection
# Author: Security Analysis Team
# Date: 2025-12-18
# Description: SIEM detection rules for AsyncRAT malware campaigns

---
title: AsyncRAT SSL Certificate Detection
id: a1b2c3d4-e5f6-7890-abcd-ef1234567890
status: experimental
description: Detects network connections using AsyncRAT SSL certificates
references:
    - https://github.com/NYAN-x-CAT/AsyncRAT-C-Sharp
    - https://bazaar.abuse.ch/
author: Security Analysis Team
date: 2025/12/18
tags:
    - attack.command_and_control
    - attack.t1071.001
    - attack.t1573.001
logsource:
    category: network_connection
    product: proxy
detection:
    selection:
        - ssl_issuer|contains: 'AsyncRAT Server'
        - ssl_subject|contains: 'AsyncRAT Server'
        - ssl_subject|contains: 'CN=AsyncRAT'
    condition: selection
falsepositives:
    - Unlikely, specific to AsyncRAT
level: critical

---
title: AsyncRAT Default Port C2 Communication
id: b2c3d4e5-f6a7-8901-bcde-f12345678901
status: stable
description: Detects connections to AsyncRAT default C2 port 6606
references:
    - https://github.com/NYAN-x-CAT/AsyncRAT-C-Sharp
author: Security Analysis Team
date: 2025/12/18
tags:
    - attack.command_and_control
    - attack.t1071.001
logsource:
    category: network_connection
    product: zeek
detection:
    selection:
        destination_port: 6606
        ssl_subject|contains: 'AsyncRAT'
    condition: selection
falsepositives:
    - Legitimate use of port 6606 (rare)
level: high

---
title: AsyncRAT Process Injection Into Aspnet_Compiler
id: c3d4e5f6-a7b8-9012-cdef-123456789012
status: experimental
description: Detects AsyncRAT injection into aspnet_compiler.exe process
references:
    - https://www.trendmicro.com/en_us/research/23/l/analyzing-asyncrat-code-injection-into-aspnetcompiler-exe.html
author: Security Analysis Team
date: 2025/12/18
tags:
    - attack.defense_evasion
    - attack.t1055
    - attack.privilege_escalation
logsource:
    category: process_creation
    product: windows
detection:
    selection_target:
        Image|endswith: '\\aspnet_compiler.exe'
    selection_network:
        CommandLine|contains: 
            - 'aspnet_compiler'
    selection_suspicious:
        - ParentImage|endswith:
            - '\\powershell.exe'
            - '\\cmd.exe'
            - '\\wscript.exe'
            - '\\mshta.exe'
        - NetworkConnection: true
    condition: selection_target and (selection_network or selection_suspicious)
falsepositives:
    - Legitimate ASP.NET compilation (rare from suspicious parents)
level: high

---
title: AsyncRAT Scheduled Task Persistence
id: d4e5f6a7-b8c9-0123-def1-234567890123
status: stable
description: Detects AsyncRAT creating scheduled tasks for persistence
references:
    - Multiple AsyncRAT campaigns
author: Security Analysis Team
date: 2025/12/18
tags:
    - attack.persistence
    - attack.t1053.005
logsource:
    category: process_creation
    product: windows
detection:
    selection_schtasks:
        Image|endswith: '\\schtasks.exe'
        CommandLine|contains: '/create'
    selection_names:
        CommandLine|contains:
            - 'Skype Updater'
            - 'Windows Updater'
            - 'Chrome Updater'
            - 'System Update'
    selection_suspicious:
        CommandLine|contains:
            - 'powershell'
            - 'wscript'
            - 'mshta'
            - '\\AppData\\'
            - '\\Temp\\'
    condition: selection_schtasks and (selection_names or selection_suspicious)
falsepositives:
    - Legitimate software updates (check task details)
level: medium

---
title: AsyncRAT PowerShell Encoded Command Execution
id: e5f6a7b8-c9d0-1234-ef12-345678901234
status: experimental
description: Detects PowerShell encoded commands associated with AsyncRAT loaders
references:
    - https://www.splunk.com/en_us/blog/security/asyncrat-crusade-detections-and-defense.html
author: Security Analysis Team
date: 2025/12/18
tags:
    - attack.execution
    - attack.t1059.001
    - attack.defense_evasion
    - attack.t1027
logsource:
    category: process_creation
    product: windows
detection:
    selection_ps:
        Image|endswith: '\\powershell.exe'
    selection_encoded:
        CommandLine|contains:
            - '-encodedcommand'
            - '-enc'
            - '-e '
            - '-w hidden'
            - '-windowstyle hidden'
    selection_suspicious:
        CommandLine|contains:
            - 'FromBase64String'
            - 'GzipStream'
            - 'Reflection.Assembly'
            - 'VirtualAlloc'
            - 'WriteProcessMemory'
    condition: selection_ps and selection_encoded and selection_suspicious
falsepositives:
    - Legitimate administrative scripts (rare with these combinations)
level: high

---
title: AsyncRAT AMSI Bypass Attempt
id: f6a7b8c9-d0e1-2345-f123-456789012345
status: experimental
description: Detects AMSI bypass techniques used by AsyncRAT
references:
    - https://levelblue.com/blogs/security-essentials/asyncrat-in-action-fileless-malware-techniques
author: Security Analysis Team
date: 2025/12/18
tags:
    - attack.defense_evasion
    - attack.t1562.001
logsource:
    category: process_creation
    product: windows
detection:
    selection_ps:
        Image|endswith: '\\powershell.exe'
    selection_amsi:
        CommandLine|contains:
            - 'AmsiScanBuffer'
            - 'amsi.dll'
            - 'AmsiInitFailed'
            - '[Ref].Assembly.GetType'
            - 'System.Management.Automation.AmsiUtils'
    condition: selection_ps and selection_amsi
falsepositives:
    - Security research in controlled environments
level: critical

---
title: AsyncRAT ETW Patching Detection
id: a7b8c9d0-e1f2-3456-1234-567890123456
status: experimental
description: Detects Event Tracing for Windows (ETW) patching by AsyncRAT
references:
    - https://levelblue.com/blogs/security-essentials/asyncrat-in-action-fileless-malware-techniques
author: Security Analysis Team
date: 2025/12/18
tags:
    - attack.defense_evasion
    - attack.t1562.001
logsource:
    category: process_creation
    product: windows
detection:
    selection:
        CommandLine|contains:
            - 'EtwEventWrite'
            - 'ntdll.dll'
            - 'PatchETW'
            - 'etw'
    condition: selection
falsepositives:
    - Legitimate ETW management (rare)
level: high

---
title: AsyncRAT OneNote Dropper Execution
id: b8c9d0e1-f2a3-4567-2345-678901234567
status: experimental
description: Detects OneNote files executing embedded HTA or batch scripts for AsyncRAT
references:
    - https://www.splunk.com/en_us/blog/security/asyncrat-crusade-detections-and-defense.html
author: Security Analysis Team
date: 2025/12/18
tags:
    - attack.execution
    - attack.t1204.002
    - attack.initial_access
    - attack.t1566.001
logsource:
    category: process_creation
    product: windows
detection:
    selection_onenote:
        ParentImage|endswith: '\\onenote.exe'
    selection_child:
        Image|endswith:
            - '\\mshta.exe'
            - '\\wscript.exe'
            - '\\cscript.exe'
            - '\\cmd.exe'
            - '\\powershell.exe'
    condition: selection_onenote and selection_child
falsepositives:
    - Legitimate OneNote macros (very rare)
level: high

---
title: AsyncRAT Keylogger Log File Creation
id: c9d0e1f2-a3b4-5678-3456-789012345678
status: stable
description: Detects creation of AsyncRAT keylogger temporary log files
references:
    - https://www.mcafee.com/blogs/other-blogs/mcafee-labs/unmasking-asyncrat-new-infection-chain/
author: Security Analysis Team
date: 2025/12/18
tags:
    - attack.collection
    - attack.t1056.001
    - attack.credential_access
logsource:
    category: file_event
    product: windows
detection:
    selection:
        TargetFilename|contains: '\\Temp\\'
        TargetFilename|endswith: 
            - '\\log.tmp'
            - '\\keylog.txt'
            - '\\keys.log'
    condition: selection
falsepositives:
    - Legitimate applications creating similar temp files (low probability)
level: medium

---
title: AsyncRAT ClickFix Social Engineering Technique
id: d0e1f2a3-b4c5-6789-4567-890123456789
status: experimental
description: Detects ClickFix technique used in AsyncRAT campaigns (Storm-1865)
references:
    - https://www.centripetal.ai/threat-research/discord-invites-leveraged-in-malware-distribution
    - https://www.cyfirma.com/news/weekly-intelligence-report-21-mar-2025/
author: Security Analysis Team
date: 2025/12/18
tags:
    - attack.execution
    - attack.t1204.002
    - attack.initial_access
    - attack.t1566
logsource:
    category: process_creation
    product: windows
detection:
    selection_mshta:
        Image|endswith: '\\mshta.exe'
    selection_command:
        CommandLine|contains:
            - 'javascript:'
            - 'vbscript:'
    selection_browser_parent:
        ParentImage|endswith:
            - '\\chrome.exe'
            - '\\msedge.exe'
            - '\\firefox.exe'
            - '\\iexplore.exe'
    condition: selection_mshta and selection_command and selection_browser_parent
falsepositives:
    - Rare legitimate MSHTA usage from browsers
level: high

---
title: AsyncRAT Process Criticality Flag
id: e1f2a3b4-c5d6-7890-5678-901234567890
status: experimental
description: Detects use of RtlSetProcessIsCritical API by AsyncRAT
references:
    - https://blog.qualys.com/vulnerabilities-threat-research/2022/08/16/asyncrat-c2-framework-overview-technical-analysis-and-detection
author: Security Analysis Team
date: 2025/12/18
tags:
    - attack.defense_evasion
    - attack.t1562.001
    - attack.persistence
logsource:
    category: api_call
    product: windows
detection:
    selection:
        CallTrace|contains: 'ntdll.dll'
        TargetFunction: 'RtlSetProcessIsCritical'
    condition: selection
falsepositives:
    - System processes (whitelist known legitimate processes)
level: critical

---
title: AsyncRAT RegSvcs Process Injection
id: f2a3b4c5-d6e7-8901-6789-012345678901
status: stable
description: Detects AsyncRAT injection into RegSvcs.exe
references:
    - https://www.mcafee.com/blogs/other-blogs/mcafee-labs/unmasking-asyncrat-new-infection-chain/
author: Security Analysis Team
date: 2025/12/18
tags:
    - attack.defense_evasion
    - attack.t1055
logsource:
    category: network_connection
    product: windows
detection:
    selection:
        Image|endswith: '\\RegSvcs.exe'
        Initiated: 'true'
        DestinationIsIpv4: 'true'
    filter_microsoft:
        DestinationIp|startswith:
            - '10.'
            - '172.16.'
            - '192.168.'
    condition: selection and not filter_microsoft
falsepositives:
    - Legitimate RegSvcs.exe network activity (very rare)
level: high

---
title: AsyncRAT Python Loader Detection
id: a3b4c5d6-e7f8-9012-7890-123456789012
status: experimental
description: Detects Python-based AsyncRAT loaders
references:
    - https://www.forcepoint.com/blog/x-labs/asyncrat-reloaded-python-trycloudflare-malware
author: Security Analysis Team
date: 2025/12/18
tags:
    - attack.execution
    - attack.t1059.006
    - attack.defense_evasion
logsource:
    category: process_creation
    product: windows
detection:
    selection_python:
        Image|endswith: 
            - '\\python.exe'
            - '\\pythonw.exe'
    selection_suspicious:
        CommandLine|contains:
            - 'load.py'
            - 'ctypes'
            - 'VirtualAlloc'
            - 'CreateThread'
            - 'base64'
    condition: selection_python and selection_suspicious
falsepositives:
    - Legitimate Python scripts with similar functionality
level: medium

---
title: AsyncRAT TryCloudflare Tunnel Connection
id: b4c5d6e7-f8a9-0123-8901-234567890123
status: experimental
description: Detects connections to TryCloudflare tunnels used by AsyncRAT
references:
    - https://www.forcepoint.com/blog/x-labs/asyncrat-reloaded-python-trycloudflare-malware
author: Security Analysis Team
date: 2025/12/18
tags:
    - attack.command_and_control
    - attack.t1071.001
logsource:
    category: dns_query
    product: windows
detection:
    selection:
        query|endswith: '.trycloudflare.com'
    condition: selection
falsepositives:
    - Legitimate use of Cloudflare tunnels for development
level: medium

---
title: AsyncRAT Dropbox Payload Delivery
id: c5d6e7f8-a9b0-1234-9012-345678901234
status: experimental
description: Detects AsyncRAT payload delivery via Dropbox
references:
    - https://www.forcepoint.com/blog/x-labs/asyncrat-reloaded-python-trycloudflare-malware
author: Security Analysis Team
date: 2025/12/18
tags:
    - attack.command_and_control
    - attack.t1071.001
    - attack.initial_access
logsource:
    category: web_proxy
    product: proxy
detection:
    selection:
        url|contains: 
            - 'dl.dropboxusercontent.com'
            - 'dropbox.com/scl/fi/'
        url|endswith:
            - '.zip'
            - '.exe'
            - '.bat'
    condition: selection
falsepositives:
    - Legitimate Dropbox file downloads
level: low

---
title: AsyncRAT Cryptocurrency Wallet Extension Targeting
id: d6e7f8a9-b0c1-2345-0123-456789012345
status: experimental
description: Detects AsyncRAT variant targeting cryptocurrency wallet extensions (Desert Dexter)
references:
    - https://www.cyfirma.com/news/weekly-intelligence-report-14-mar-2025/
author: Security Analysis Team
date: 2025/12/18
tags:
    - attack.collection
    - attack.t1005
    - attack.credential_access
logsource:
    category: file_access
    product: windows
detection:
    selection_browser:
        Image|endswith:
            - '\\chrome.exe'
            - '\\msedge.exe'
            - '\\brave.exe'
            - '\\firefox.exe'
    selection_wallet_paths:
        TargetFilename|contains:
            - '\\MetaMask\\'
            - '\\Phantom\\'
            - '\\Coinbase Wallet\\'
            - '\\Trust Wallet\\'
            - '\\Binance\\'
    condition: selection_browser and selection_wallet_paths
falsepositives:
    - Legitimate browser extension updates
level: medium

---
title: AsyncRAT Telegram Bot Exfiltration
id: e7f8a9b0-c1d2-3456-1234-567890123456
status: experimental
description: Detects data exfiltration to Telegram bot by AsyncRAT
references:
    - https://www.cyfirma.com/news/weekly-intelligence-report-14-mar-2025/
author: Security Analysis Team
date: 2025/12/18
tags:
    - attack.exfiltration
    - attack.t1041
    - attack.command_and_control
logsource:
    category: network_connection
    product: firewall
detection:
    selection:
        DestinationHostname|contains: 'api.telegram.org'
        url|contains: 
            - '/sendMessage'
            - '/sendPhoto'
            - '/sendDocument'
    condition: selection
falsepositives:
    - Legitimate Telegram bot usage
level: medium

---
title: AsyncRAT Multiple Failed Persistence Attempts
id: f8a9b0c1-d2e3-4567-2345-678901234567
status: experimental
description: Detects multiple AsyncRAT persistence mechanism attempts
references:
    - General AsyncRAT behavior
author: Security Analysis Team
date: 2025/12/18
tags:
    - attack.persistence
    - attack.t1053.005
    - attack.t1547.001
logsource:
    category: process_creation
    product: windows
detection:
    selection_reg:
        CommandLine|contains: 'CurrentVersion\\Run'
    selection_schtasks:
        Image|endswith: '\\schtasks.exe'
    selection_startup:
        TargetFilename|contains: '\\Startup\\'
    timeframe: 5m
    condition: (selection_reg and selection_schtasks) or (selection_schtasks and selection_startup) 
falsepositives:
    - Software installers creating multiple persistence mechanisms
level: high

---
title: AsyncRAT ISO File Execution Chain
id: a9b0c1d2-e3f4-5678-3456-789012345678
status: experimental
description: Detects AsyncRAT delivery via ISO files with embedded scripts
references:
    - https://www.mcafee.com/blogs/other-blogs/mcafee-labs/unmasking-asyncrat-new-infection-chain/
author: Security Analysis Team
date: 2025/12/18
tags:
    - attack.execution
    - attack.t1204.002
logsource:
    category: file_event
    product: windows
detection:
    selection_mount:
        TargetFilename|contains: '\\Windows\\System32\\drivers\\cdrom.sys'
        Image|endswith: '\\explorer.exe'
    selection_execution:
        Image|contains:
            - ':\\'  # Mounted drive letter
        Image|endswith:
            - '\\powershell.exe'
            - '\\cmd.exe'
            - '\\wscript.exe'
    timeframe: 10s
    condition: selection_mount | near selection_execution
falsepositives:
    - Legitimate ISO file usage
level: medium
